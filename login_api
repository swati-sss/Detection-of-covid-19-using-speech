import React
import os.log

@objc(CompassViewManager)
class CompassViewManager: RCTViewManager {
    private let log = OSLog(subsystem: Bundle.main.bundleIdentifier ?? "com.compass.map", category: "CompassViewManager")
    
    override func view() -> UIView! {
        if let compassViewLast = ViewController.shared.compassViewList.last {
            os_log("CompassViewManager: removing stale CompassView before creating new instance", log: log)
            compassViewLast.removeFromSuperview()
            ViewController.shared.compassViewList.removeLast()
        }
        os_log("CompassViewManager: creating fresh CompassView", log: log)
        return CompassView()
    }

    override static func requiresMainQueueSetup() -> Bool {
        return true
    }
}
